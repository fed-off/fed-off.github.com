var C="ademar-cart-items";function r(){try{let n=localStorage.getItem(C);return(n?JSON.parse(n):[]).map(e=>typeof e=="string"?{name:e,price:"\u043F\u043E \u0437\u0430\u043F\u0440\u043E\u0441\u0443",url:""}:e.url?e:{...e,url:""})}catch{return[]}}function f(n){try{localStorage.setItem(C,JSON.stringify(n)),p()}catch{}}function x(n){let t=r();t.splice(n,1),f(t),y()}function p(){let t=r().length,e=document.querySelector(".header__cart-count");e&&(e.textContent=t);let o=document.querySelector(".cart-float"),s=document.querySelector(".cart-float__count");o&&s&&(s.textContent=t,t>0?o.classList.add("cart-float--show"):o.classList.remove("cart-float--show"))}function y(){let n=document.querySelector(".contact-form__product-list");if(!n)return;let t=r();if(n.innerHTML="",t.length===0){n.style.display="none";let e=document.querySelector(".contact-form__empty-message");e&&(e.style.display="block")}else{n.style.display="grid";let e=document.querySelector(".contact-form__empty-message");e&&(e.style.display="none"),t.forEach((o,s)=>{let c=document.createElement("li");c.className="contact-form__product-item";let l=document.createElement("h3");if(l.className="contact-form__product-name",o.url){let u=document.createElement("a");u.href=o.url,u.textContent=o.name,u.className="contact-form__product-link",l.appendChild(u)}else l.textContent=o.name;let i=document.createElement("p");i.className="contact-form__product-price";let m=document.createElement("span");m.className="contact-form__product-price-label",m.textContent="\u0426\u0435\u043D\u0430:";let d=document.createElement("span");d.className="contact-form__product-price-value",d.textContent=o.price,i.appendChild(m),i.appendChild(d);let a=document.createElement("button");a.className="contact-form__product-remove",a.type="button",a.textContent="\u0423\u0434\u0430\u043B\u0438\u0442\u044C",a.addEventListener("click",()=>x(s)),c.appendChild(l),c.appendChild(i),c.appendChild(a),n.appendChild(c)})}p()}function L(n){let t=r();return t.some(o=>o.name===n.name)?!1:(t.push(n),f(t),!0)}function q(n){let t=r(),e=t.findIndex(o=>o.name===n);return e>-1?(t.splice(e,1),f(t),!0):!1}function h(n){return r().some(e=>e.name===n)}function g(n){let t=n.closest("article");if(!t)return null;let e=t.querySelector(".catalog__card-link");if(!e)return null;let o=t.querySelector(".catalog__price-value");return o?{name:e.textContent.trim(),price:o.textContent.trim(),url:e.getAttribute("href")||""}:null}function E(n){let t=n.closest("section");if(!t)return null;let e=t.querySelector(".product-hero__title");if(!e)return null;let o=t.querySelector(".product-hero__price-value");return o?{name:e.textContent.trim(),price:o.textContent.trim(),url:window.location.pathname}:null}function S(){document.querySelectorAll(".catalog__button--cart").forEach(t=>{let e=null;t.closest("article")?e=g(t):t.closest(".product-hero")&&(e=E(t)),e&&(h(e.name)?(t.classList.add("in-cart"),t.textContent="\u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0435"):(t.classList.remove("in-cart"),t.textContent=t.closest("article")?"\u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0443":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432 \u043A\u043E\u0440\u0437\u0438\u043D\u0443"))})}function _(n){let t=n.target.closest(".catalog__button--cart");if(!t)return;let e=null;t.closest("article")?e=g(t):t.closest(".product-hero")&&(e=E(t)),e&&(h(e.name)?q(e.name):L(e),S())}document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".contact-form__product-list")&&y(),p(),S(),document.querySelectorAll(".catalog__list").forEach(e=>{e.addEventListener("click",_)});let t=document.querySelector(".product-hero");t&&t.addEventListener("click",_)});export{L as addToCart,r as getCartItems,h as isInCart,f as saveCartItems,p as updateCartCount};
