var p="ademar-cart-items";function o(){try{let n=localStorage.getItem(p);return(n?JSON.parse(n):[]).map(e=>typeof e=="string"?{name:e,price:"\u043F\u043E \u0437\u0430\u043F\u0440\u043E\u0441\u0443",url:""}:e.url?e:{...e,url:""})}catch{return[]}}function m(n){try{localStorage.setItem(p,JSON.stringify(n)),d()}catch{}}function S(n){let t=o();t.splice(n,1),m(t),_()}function d(){let t=o().length,e=document.querySelector(".header__cart-count");e&&(e.textContent=t);let r=document.querySelector(".cart-float"),s=document.querySelector(".cart-float__count");r&&s&&(s.textContent=t,t>0?r.classList.add("cart-float--show"):r.classList.remove("cart-float--show"))}function _(){let n=document.querySelector(".contact-form__product-list");if(!n)return;let t=o();if(n.innerHTML="",t.length===0){n.style.display="none";let e=document.querySelector(".contact-form__empty-message");e&&(e.style.display="block")}else{n.style.display="grid";let e=document.querySelector(".contact-form__empty-message");e&&(e.style.display="none"),t.forEach((r,s)=>{let c=document.createElement("li");c.className="contact-form__product-item";let l=document.createElement("h3");if(l.className="contact-form__product-name",r.url){let i=document.createElement("a");i.href=r.url,i.textContent=r.name,i.className="contact-form__product-link",l.appendChild(i)}else l.textContent=r.name;let u=document.createElement("p");u.className="contact-form__product-price",u.textContent=`\u0426\u0435\u043D\u0430: ${r.price}`;let a=document.createElement("button");a.className="contact-form__product-remove",a.type="button",a.textContent="\u0423\u0434\u0430\u043B\u0438\u0442\u044C",a.addEventListener("click",()=>S(s)),c.appendChild(l),c.appendChild(u),c.appendChild(a),n.appendChild(c)})}d()}function E(n){let t=o();return t.some(r=>r.name===n.name)?!1:(t.push(n),m(t),!0)}function x(n){let t=o(),e=t.findIndex(r=>r.name===n);return e>-1?(t.splice(e,1),m(t),!0):!1}function C(n){return o().some(e=>e.name===n)}function y(n){let t=n.closest("article");if(!t)return null;let e=t.querySelector(".catalog__card-link");if(!e)return null;let r=t.querySelector(".catalog__price-value");return r?{name:e.textContent.trim(),price:r.textContent.trim(),url:e.getAttribute("href")||""}:null}function h(n){let t=n.closest("section");if(!t)return null;let e=t.querySelector(".product-hero__title");if(!e)return null;let r=t.querySelector(".product-hero__price-value");return r?{name:e.textContent.trim(),price:r.textContent.trim(),url:window.location.pathname}:null}function g(){document.querySelectorAll(".catalog__button--cart").forEach(t=>{let e=null;t.closest("article")?e=y(t):t.closest(".product-hero")&&(e=h(t)),e&&(C(e.name)?(t.classList.add("in-cart"),t.textContent="\u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0435"):(t.classList.remove("in-cart"),t.textContent=t.closest("article")?"\u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0443":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432 \u043A\u043E\u0440\u0437\u0438\u043D\u0443"))})}function f(n){let t=n.target.closest(".catalog__button--cart");if(!t)return;let e=null;t.closest("article")?e=y(t):t.closest(".product-hero")&&(e=h(t)),e&&(C(e.name)?x(e.name):E(e),g())}document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".contact-form__product-list")&&_(),d(),g(),document.querySelectorAll(".catalog__list").forEach(e=>{e.addEventListener("click",f)});let t=document.querySelector(".product-hero");t&&t.addEventListener("click",f)});export{E as addToCart,o as getCartItems,C as isInCart,m as saveCartItems,d as updateCartCount};
