var T=Object.defineProperty;var M=(s,e)=>()=>(s&&(e=s(s=0)),e);var P=(s,e)=>{for(var t in e)T(s,t,{get:e[t],enumerable:!0})};var $={};P($,{addToCart:()=>S,getCartItems:()=>u,isInCart:()=>y,saveCartItems:()=>p,updateCartCount:()=>L});function u(){try{let s=localStorage.getItem(x);return(s?JSON.parse(s):[]).map(t=>typeof t=="string"?{name:t,price:"\u043F\u043E \u0437\u0430\u043F\u0440\u043E\u0441\u0443",url:""}:t.url?t:{...t,url:""})}catch{return[]}}function p(s){try{localStorage.setItem(x,JSON.stringify(s)),L()}catch{}}function O(s){let e=u();e.splice(s,1),p(e),B()}function L(){let e=u().length,t=document.querySelector(".header__cart-count");t&&(t.textContent=e);let n=document.querySelector(".cart-float"),a=document.querySelector(".cart-float__count");n&&a&&(a.textContent=e,e>0?n.classList.add("cart-float--show"):n.classList.remove("cart-float--show"))}function B(){let s=document.querySelector(".contact-form__product-list");if(!s)return;let e=u();if(s.innerHTML="",e.length===0){s.style.display="none";let t=document.querySelector(".contact-form__empty-message");t&&(t.style.display="block")}else{s.style.display="grid";let t=document.querySelector(".contact-form__empty-message");t&&(t.style.display="none"),e.forEach((n,a)=>{let c=document.createElement("li");c.className="contact-form__product-item";let o=document.createElement("h3");if(o.className="contact-form__product-name",n.url){let i=document.createElement("a");i.href=n.url,i.textContent=n.name,i.className="contact-form__product-link",o.appendChild(i)}else o.textContent=n.name;let l=document.createElement("p");l.className="contact-form__product-price",l.textContent=`\u0426\u0435\u043D\u0430: ${n.price}`;let r=document.createElement("button");r.className="contact-form__product-remove",r.type="button",r.textContent="\u0423\u0434\u0430\u043B\u0438\u0442\u044C",r.addEventListener("click",()=>O(a)),c.appendChild(o),c.appendChild(l),c.appendChild(r),s.appendChild(c)})}L()}function S(s){let e=u();return e.some(n=>n.name===s.name)?!1:(e.push(s),p(e),!0)}function H(s){let e=u(),t=e.findIndex(n=>n.name===s);return t>-1?(e.splice(t,1),p(e),!0):!1}function y(s){return u().some(t=>t.name===s)}function F(s){let e=s.closest("article");if(!e)return null;let t=e.querySelector(".catalog__card-link");if(!t)return null;let n=e.querySelector(".catalog__price-value");return n?{name:t.textContent.trim(),price:n.textContent.trim(),url:t.getAttribute("href")||""}:null}function N(s){let e=s.closest("section");if(!e)return null;let t=e.querySelector(".product-hero__title");if(!t)return null;let n=e.querySelector(".product-hero__price-value");return n?{name:t.textContent.trim(),price:n.textContent.trim(),url:window.location.pathname}:null}function q(){document.querySelectorAll(".catalog__button--cart").forEach(e=>{let t=null;e.closest("article")?t=F(e):e.closest(".product-hero")&&(t=N(e)),t&&(y(t.name)?(e.classList.add("in-cart"),e.textContent="\u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0435"):(e.classList.remove("in-cart"),e.textContent=e.closest("article")?"\u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0443":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432 \u043A\u043E\u0440\u0437\u0438\u043D\u0443"))})}function b(s){let e=s.target.closest(".catalog__button--cart");if(!e)return;let t=null;e.closest("article")?t=F(e):e.closest(".product-hero")&&(t=N(e)),t&&(y(t.name)?H(t.name):S(t),q())}var x,D=M(()=>{x="ademar-cart-items";document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".contact-form__product-list")&&B(),L(),q(),document.querySelectorAll(".catalog__list").forEach(t=>{t.addEventListener("click",b)});let e=document.querySelector(".product-hero");e&&e.addEventListener("click",b)})});var v=document.getElementById("contactForm"),f=document.getElementById("contactFile"),_=document.getElementById("fileList"),E=document.getElementById("formSuccess"),C=document.getElementById("catalogContactForm"),m=document.getElementById("catalogContactFile"),g=document.getElementById("catalogFileName"),k=document.getElementById("catalogFormSuccess"),d=[];function J(){let s=Math.floor(Date.now()/1e3);return String(s)}function I(){_&&(_.innerHTML="",d.forEach((s,e)=>{let t=document.createElement("li");t.className="contact-form__file-item";let n=document.createElement("span");n.textContent=s.name;let a=document.createElement("button");a.className="contact-form__file-remove",a.type="button",a.setAttribute("aria-label",`\u0423\u0434\u0430\u043B\u0438\u0442\u044C ${s.name}`),a.addEventListener("click",()=>z(e)),t.appendChild(n),t.appendChild(a),_.appendChild(t)}))}function z(s){d.splice(s,1),I()}f&&f.addEventListener("change",()=>{let e=Array.from(f.files);if(d.length+e.length>8){alert(`\u041C\u0430\u043A\u0441\u0438\u043C\u0443\u043C 8 \u0444\u0430\u0439\u043B\u043E\u0432. \u0412\u044B \u043C\u043E\u0436\u0435\u0442\u0435 \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0435\u0449\u0451 ${8-d.length} \u0444\u0430\u0439\u043B(\u043E\u0432).`),f.value="";return}d=[...d,...e],f.value="",I()});v&&v.addEventListener("submit",async s=>{s.preventDefault();let{getCartItems:e}=await Promise.resolve().then(()=>(D(),$)),t=e(),n={customerInfo:{name:document.getElementById("contactName").value,company:document.getElementById("contactCompany").value||"\u043D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D\u0430",phone:document.getElementById("contactPhone").value,email:document.getElementById("contactEmail").value||"\u043D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D"},orderDetails:{message:document.getElementById("contactMessage").value,cartItems:t.map(l=>({productName:l.name,price:l.price}))},files:[],timestamp:new Date().toISOString(),formType:"order_request"},a=[];for(let l=0;l<d.length;l++)a.push({name:d[l].name,size:d[l].size,type:d[l].type});n.files=a;let c=new FormData;c.append("data",JSON.stringify(n));for(let l=0;l<d.length;l++)c.append("files",d[l]);let o=J();n.orderNumber=o,setTimeout(()=>{let l=document.getElementById("orderNumber");l&&(l.textContent=o),E.classList.add("contact-form__success--visible"),v.reset(),d=[],I(),v.querySelectorAll(".contact-form__input, .contact-form__textarea").forEach(h=>{h.classList.remove("valid","invalid")}),v.querySelectorAll(".contact-form__error").forEach(h=>{h.classList.remove("visible")})},500)});if(E){let s=E.querySelector(".contact-form__success-close");s&&s.addEventListener("click",()=>{E.classList.remove("contact-form__success--visible")})}function R(){let s=document.getElementById("contactName"),e=document.getElementById("contactCompany"),t=document.getElementById("contactPhone"),n=document.getElementById("contactEmail"),a=document.getElementById("contactMessage"),c=document.getElementById("nameError"),o=document.getElementById("phoneError"),l=document.getElementById("emailError"),r=document.getElementById("messageError");s&&c&&(s.addEventListener("blur",()=>{s.value.trim()?s.value.trim().length<2?(s.classList.add("invalid"),s.classList.remove("valid"),c.textContent="\u0418\u043C\u044F \u0434\u043E\u043B\u0436\u043D\u043E \u0441\u043E\u0434\u0435\u0440\u0436\u0430\u0442\u044C \u043C\u0438\u043D\u0438\u043C\u0443\u043C 2 \u0441\u0438\u043C\u0432\u043E\u043B\u0430",c.classList.add("visible")):(s.classList.remove("invalid"),s.classList.add("valid"),c.classList.remove("visible")):(s.classList.add("invalid"),s.classList.remove("valid"),c.classList.add("visible"))}),s.addEventListener("input",()=>{let i=s.value.trim();s.classList.contains("invalid")&&(s.classList.remove("invalid"),c.classList.remove("visible")),i.length>=2?s.classList.add("valid"):s.classList.remove("valid")})),e&&(e.addEventListener("input",()=>{e.value.trim().length>0?e.classList.add("valid"):e.classList.remove("valid")}),e.addEventListener("blur",()=>{e.value.trim().length>0?e.classList.add("valid"):e.classList.remove("valid")})),t&&o&&(t.addEventListener("blur",()=>{let i=t.value.replace(/\D/g,"");i.length>0&&i.length<11?(t.classList.add("invalid"),t.classList.remove("valid"),o.classList.add("visible")):i.length===0?(t.classList.add("invalid"),t.classList.remove("valid"),o.textContent="\u0422\u0435\u043B\u0435\u0444\u043E\u043D \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u0435\u043D \u0434\u043B\u044F \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F",o.classList.add("visible")):i.length===11&&(t.classList.remove("invalid"),t.classList.add("valid"),o.classList.remove("visible"))}),t.addEventListener("input",()=>{let i=t.value.replace(/\D/g,"");t.classList.contains("invalid")&&(t.classList.remove("invalid"),o.classList.remove("visible")),i.length===11?t.classList.add("valid"):t.classList.remove("valid")})),n&&l&&(n.addEventListener("blur",()=>{n.value&&!n.validity.valid?(n.classList.add("invalid"),n.classList.remove("valid"),l.classList.add("visible")):n.value&&n.validity.valid?(n.classList.remove("invalid"),n.classList.add("valid"),l.classList.remove("visible")):(n.classList.remove("invalid"),n.classList.remove("valid"),l.classList.remove("visible"))}),n.addEventListener("input",()=>{n.classList.contains("invalid")&&(n.classList.remove("invalid"),l.classList.remove("visible")),n.value&&n.validity.valid?n.classList.add("valid"):n.classList.remove("valid")})),a&&r&&(a.addEventListener("blur",()=>{a.value.trim()?a.value.trim().length<10?(a.classList.add("invalid"),a.classList.remove("valid"),r.textContent="\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043E\u043F\u0438\u0448\u0438\u0442\u0435 \u0432\u0430\u0448 \u0437\u0430\u043A\u0430\u0437 \u043F\u043E\u0434\u0440\u043E\u0431\u043D\u0435\u0435 (\u043C\u0438\u043D\u0438\u043C\u0443\u043C 10 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432)",r.classList.add("visible")):(a.classList.remove("invalid"),a.classList.add("valid"),r.classList.remove("visible")):(a.classList.add("invalid"),a.classList.remove("valid"),r.textContent="\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0437\u0430\u043A\u0430\u0437\u0430 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E",r.classList.add("visible"))}),a.addEventListener("input",()=>{let i=a.value.trim();a.classList.contains("invalid")&&(a.classList.remove("invalid"),r.classList.remove("visible")),i.length>=10?a.classList.add("valid"):a.classList.remove("valid")}))}v&&R();var w=document.getElementById("contactPhone");w&&w.addEventListener("input",s=>{let e=s.target.value.replace(/\D/g,"").slice(0,11),t=e[0]||"";e.length>1&&(t+=` ${e.substring(1,4)}`),e.length>=5&&(t+=` ${e.substring(4,7)}`),e.length>=8&&(t+=` ${e.substring(7,9)}`),e.length>=10&&(t+=` ${e.substring(9,11)}`),s.target.value=t});m&&m.addEventListener("change",()=>{if(m.files.length>8){alert("\u041C\u0430\u043A\u0441\u0438\u043C\u0443\u043C 8 \u0444\u0430\u0439\u043B\u043E\u0432. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043C\u0435\u043D\u044C\u0448\u0435 \u0444\u0430\u0439\u043B\u043E\u0432."),m.value="",g.textContent="\u0424\u0430\u0439\u043B\u044B \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u044B";return}m.files.length>0?m.files.length===1?g.textContent=m.files[0].name:g.textContent=`\u0412\u044B\u0431\u0440\u0430\u043D\u043E \u0444\u0430\u0439\u043B\u043E\u0432: ${m.files.length}`:g.textContent="\u0424\u0430\u0439\u043B\u044B \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u044B"});C&&C.addEventListener("submit",s=>{s.preventDefault(),setTimeout(()=>{k.classList.add("contact-form__success--visible"),C.reset(),g.textContent="\u0424\u0430\u0439\u043B\u044B \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u044B",setTimeout(()=>{k.classList.remove("contact-form__success--visible")},5e3)},500)});var A=document.getElementById("catalogContactPhone");A&&A.addEventListener("input",s=>{let e=s.target.value.replace(/\D/g,"").slice(0,11),t=e[0]||"";e.length>1&&(t+=` ${e.substring(1,4)}`),e.length>=5&&(t+=` ${e.substring(4,7)}`),e.length>=8&&(t+=` ${e.substring(7,9)}`),e.length>=10&&(t+=` ${e.substring(9,11)}`),s.target.value=t});
